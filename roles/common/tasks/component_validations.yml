---
- name: Validate Jolokia access control configuration
  fail:
    msg: "jolokia_access_control_file_src_path must be set when jolokia_access_control_enabled and jolokia_access_control_custom_file_enabled are both true"
  when:
    - jolokia_access_control_enabled|bool
    - jolokia_access_control_custom_file_enabled|bool
    - jolokia_access_control_file_src_path == ""
  tags:
    - validate
    - validate_jolokia

- name: Validate custom Jolokia access control file exists
  stat:
    path: "{{ jolokia_access_control_file_src_path }}"
  register: jolokia_access_control_file_stat
  delegate_to: localhost
  when:
    - jolokia_access_control_enabled|bool
    - jolokia_access_control_custom_file_enabled|bool
    - jolokia_access_control_file_src_path != ""
  tags:
    - validate
    - validate_jolokia

- name: Fail if custom Jolokia access control file does not exist
  fail:
    msg: "Custom Jolokia access control file {{ jolokia_access_control_file_src_path }} does not exist"
  when:
    - jolokia_access_control_enabled|bool
    - jolokia_access_control_custom_file_enabled|bool
    - jolokia_access_control_file_src_path != ""
    - not jolokia_access_control_file_stat.stat.exists
  tags:
    - validate
    - validate_jolokia
