<?xml version="1.0" encoding="utf-8"?>
<!--
  Maximum Security Jolokia Policy for ZK to KRaft Migration
  Deny-all approach with explicit allow for only the required MBean
  Following official Jolokia documentation syntax
-->
<restrict>
  <!-- Only allow read commands -->
  <commands>
    <command>read</command>
  </commands>

  <!-- Deny all MBeans by default -->
  <mbean>
    <name>*:*</name>
    <deny/>
  </mbean>

  <!-- Allow only the specific MBean -->
  <mbean>
    <name>kafka.controller:type=KafkaController,name=ZkMigrationState</name>
    <attribute mode="read">*</attribute>
  </mbean>

</restrict>
