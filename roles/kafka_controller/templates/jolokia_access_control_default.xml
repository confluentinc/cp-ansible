<?xml version="1.0" encoding="utf-8"?>
<!--
  Jolokia Access Control Policy for ANSIENG-4748
  ZK to KRaft Migration - Secure endpoint access

  Security Requirements:
  - Block system discovery (list command)
  - Allow only migration state monitoring
  - Prevent unauthorized MBean access
  - Read-only operations only
-->
<restrict>
  <!-- Allow only read commands - blocks list, write, exec, search, notification, version -->
  <commands>
    <command>read</command>
  </commands>

  <!-- Set default deny for everything -->
  <default>deny</default>

  <!-- Then explicitly allow only the specific MBean required for migration -->
  <allow>
    <mbean>
      <name>kafka.controller:type=KafkaController,name=ZkMigrationState</name>
      <attribute mode="read">*</attribute>
    </mbean>
  </allow>


</restrict>
