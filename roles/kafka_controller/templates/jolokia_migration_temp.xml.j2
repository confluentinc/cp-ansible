<?xml version="1.0" encoding="utf-8"?>
<!--
  Temporary Jolokia Access Control Policy for ZK to KRaft Migration
  This policy allows access to specific endpoints required during migration
  and should be replaced with a more restrictive policy after migration completes
-->
<restrict>
  <!-- Allow access to migration state endpoint -->
  <mbean>
    <name>kafka.controller:type=KafkaController,name=ZkMigrationState</name>
    <operation>read</operation>
  </mbean>

  <!-- Allow access to controller state endpoint -->
  <mbean>
    <name>kafka.controller:type=KafkaController,name=ActiveControllerCount</name>
    <operation>read</operation>
  </mbean>

  <!-- Allow access to replica manager for partition monitoring -->
  <mbean>
    <name>kafka.server:type=ReplicaManager,name=UnderReplicatedPartitions</name>
    <operation>read</operation>
  </mbean>

  <!-- Allow jolokia list operation for endpoint validation -->
  <command>list</command>

  <!-- Allow jolokia read operations -->
  <command>read</command>

  <!-- Default deny for everything else -->
  <default>deny</default>
</restrict>
