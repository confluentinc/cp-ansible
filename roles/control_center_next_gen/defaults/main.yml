---
# More control_center variables are defined in the variables role

### Boolean to reconfigure Control Center's logging with RollingFileAppender and log cleanup
control_center_custom_log4j: "{{ custom_log4j }}"

### Root logger within Control Center's log4j config. Only honored if control_center_custom_log4j: true
control_center_log4j_root_logger: "INFO, main"

### Max number of log files generated by Control Center. Only honored if control_center_custom_log4j: true
control_center_max_log_files: 10

### Max size of a log file generated by Control Center. Only honored if control_center_custom_log4j: true
control_center_log_file_size: 100MB

### List of loggers to redact. This is specified alongside the user defined redactor name and appenderRefs to be used in redactor definition. The redactor name should be unique for each logger.
control_center_logredactor_logger_specs_list:
  - { logger_name: "log4j.rootLogger", appenderRefs: "main" }

control_center_java_args:
  - "{% if control_center_next_gen_ssl_enabled|bool %}-Djdk.tls.ephemeralDHKeySize=2048{% endif %}"
  - "{% if control_center_next_gen_authentication_type == 'basic' %}-Djava.security.auth.login.config={{control_center_next_gen.jaas_file}}{% endif %}"
  - "{% if kerberos_client_config_file_dest != '/etc/krb5.conf' %}-Djava.security.krb5.conf={{kerberos_client_config_file_dest}}{% endif %}"

### Custom Java Args to add to the Control Center Process
control_center_custom_java_args: ""

control_center_final_java_args: "{{ control_center_java_args + [ control_center_custom_java_args ] }}"

### Full Path to the RocksDB Data Directory. If left as empty string, cp-ansible will not configure RocksDB
control_center_rocksdb_path: ""

### Directory path to archive config files. This is used to determine the path to the config files for Control Center dependencies.
# todo/abh - move to proper archive dir post confirmation from c3 team
control_center_dependency_archive_config_file_path: "{{ archive_config_base_path if installation_method == 'archive' else '' }}/{{ config_prefix }}/confluent-control-center-next-gen"

### Directory path to rpm config files. This is used to determine the path to the config files for Control Center dependencies.
control_center_dependency_rpm_config_file_path: "{{ config_prefix }}/confluent-control-center"

prometheus_control_center_dependency_src_config_file: "{% if installation_method == 'archive' %}{{ control_center_dependency_archive_config_file_path }}/trigger_rules-generated.yml{% else %}{{ control_center_dependency_rpm_config_file_path }}/trigger_rules-generated.yml{% endif %}"

alertmanager_control_center_dependency_src_config_file: "{% if installation_method == 'archive' %}{{ control_center_dependency_archive_config_file_path }}/alertmanager-generated.yml{% else %}{{ control_center_dependency_rpm_config_file_path }}/trigger_rules-generated.yml{% endif %}"

# For following dictionaries, Key/Value Pairs with empty values will not be written into override.conf

### Overrides to the Service Section of Control Center Systemd File. This variable is a dictionary.
control_center_service_overrides:
  User: "{{ control_center_next_gen_user if control_center_next_gen_user != control_center_next_gen_default_user else '' }}"
  Group: "{{ control_center_next_gen_group if control_center_next_gen_group != control_center_next_gen_default_group else '' }}"
  ExecStart: "{% if installation_method == 'archive' %}{{ control_center_next_gen.server_start_file }} {{ control_center_next_gen.config_file }}{% endif %}"

### Overrides to the Service Section of Prometheus Control Center Systemd File. This variable is a dictionary.
prometheus_control_center_dependency_service_overrides:
  User: "{{ control_center_next_gen_user if control_center_next_gen_user != control_center_next_gen_default_user else '' }}"
  Group: "{{ control_center_next_gen_group if control_center_next_gen_group != control_center_next_gen_default_group else '' }}"
  ExecStart: "{{ control_center_next_gen_dep_prometheus.server_start_file }} {{ control_center_next_gen_dep_prometheus.config_file }}"

### Overrides to the Service Section of AlertManager Control Center Systemd File. This variable is a dictionary.
alertmanager_control_center_dependency_service_overrides:
  User: "{{ control_center_next_gen_user if control_center_next_gen_user != control_center_next_gen_default_user else '' }}"
  Group: "{{ control_center_next_gen_group if control_center_next_gen_group != control_center_next_gen_default_group else '' }}"
  ExecStart: "{{ control_center_next_gen_dep_alertmanager.server_start_file }} {{ control_center_next_gen_dep_alertmanager.config_file }}"

### Environment Variables to be added to the Control Center Service. This variable is a dictionary.
control_center_service_environment_overrides:
  ROCKSDB_SHAREDLIB_DIR: "{{control_center_rocksdb_path}}"
  CONTROL_CENTER_HEAP_OPTS: "-Xmx6g"
  CONTROL_CENTER_OPTS: "{{ control_center_final_java_args | confluent.platform.java_arg_build_out }}"
  CONTROL_CENTER_LOG4J_OPTS: "{% if control_center_custom_log4j|bool %}-Dlog4j.configuration=file:{{control_center_next_gen.log4j_file}}{% endif %}"
  # Remove trailing slash if there is one
  LOG_DIR: "{{ control_center_next_gen_log_dir|regex_replace('\\/$', '') }}"
  CONFLUENT_SECURITY_MASTER_KEY: "{% if control_center_secrets_protection_enabled|bool %}{{secrets_protection_masterkey}}{% endif %}"

### Environment Variables to be added to the Prometheus (Control Center's dependency) Service. This variable is a dictionary.
prometheus_control_center_dependency_service_environment_overrides:
  # todo/abh move to proper log dir post confirmation from c3 team
  LOG_DIR: "{{ control_center_next_gen_log_dir|regex_replace('\\/$', '') }}"

### Environment Variables to be added to the AlertManager (Control Center's dependency) Service. This variable is a dictionary.
alertmanager_control_center_dependency_service_environment_overrides:
  # todo/abh move to proper log dir post confirmation from c3 team
  LOG_DIR: "{{ control_center_next_gen_log_dir|regex_replace('\\/$', '') }}"

### Overrides to the Unit Section of Control Center Systemd File. This variable is a dictionary.
control_center_service_unit_overrides:

### Overrides to the Unit Section of Prometheus Systemd File. This variable is a dictionary.
prometheus_control_center_dependency_service_unit_overrides:

### Overrides to the Unit Section of Alert Manager Systemd File. This variable is a dictionary.
alertmanager_control_center_dependency_service_unit_overrides:

### Time in seconds to wait before starting Control Center Health Checks.
control_center_health_check_delay: 30

control_center_secrets_protection_file: "{{ ssl_file_dir_final }}/control-center-security.properties"
