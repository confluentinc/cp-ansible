---
# More kafka_rest variables are defined in the variables role

### Boolean to reconfigure Rest Proxy's logging with RollingFileAppender and log cleanup
kafka_rest_custom_log4j: "{{ custom_log4j }}"

### Root logger within Rest Proxy's log4j config. Only honored if kafka_rest_custom_log4j: true
kafka_rest_log4j_root_logger: "INFO, stdout, file"

### Max number of log files generated by Rest Proxy. Only honored if kafka_rest_custom_log4j: true
kafka_rest_max_log_files: 10

### Max size of a log file generated by Rest Proxy. Only honored if kafka_rest_custom_log4j: true
kafka_rest_log_file_size: 100MB

### List of loggers to redact. This is specified alongside the user defined redactor name and appenderRefs to be used in redactor definition. The redactor name should be unique for each logger.
kafka_rest_logredactor_logger_specs_list:
  - { logger_name: "log4j.rootLogger", appenderRefs: "file" }

kafka_rest_java_args:
  - "{% if kafka_rest_ssl_enabled|bool %}-Djdk.tls.ephemeralDHKeySize=2048{% endif %}"
  - "{% if kafka_rest_jolokia_enabled|bool %}-javaagent:{{jolokia_jar_path}}=config={{kafka_rest_jolokia_config}}{% endif %}"
  - "{% if kafka_rest_jmxexporter_enabled|bool %}-javaagent:{{jmxexporter_jar_path}}={{kafka_rest_jmxexporter_port}}:{{kafka_rest_jmxexporter_config_path}}{% endif %}"
  - "{% if kafka_rest_authentication_type == 'basic' %}-Djava.security.auth.login.config={{kafka_rest.jaas_file}}{% endif %}"
  - "{% if kerberos_client_config_file_dest != '/etc/krb5.conf' %}-Djava.security.krb5.conf={{kerberos_client_config_file_dest}}{% endif %}"

### Custom Java Args to add to the Rest Proxy Process
kafka_rest_custom_java_args: ""

kafka_rest_final_java_args: "{{ kafka_rest_java_args + [ kafka_rest_custom_java_args ] }}"

# For following dictionaries, Key/Value Pairs with empty values will not be written into override.conf

### Overrides to the Service Section of Rest Proxy Systemd File. This variable is a dictionary.
kafka_rest_service_overrides:
  User: "{{ kafka_rest_user if kafka_rest_user != kafka_rest_default_user else '' }}"
  Group: "{{ kafka_rest_group if kafka_rest_group != kafka_rest_default_group else '' }}"
  ExecStart: "{% if installation_method == 'archive' %}{{ kafka_rest.server_start_file }} {{ kafka_rest.config_file }}{% endif %}"

### Environment Variables to be added to the Rest Proxy Service. This variable is a dictionary.
kafka_rest_service_environment_overrides:
  KAFKAREST_HEAP_OPTS: "-Xms1g -Xmx1g -XX:MetaspaceSize=96m -XX:+UseG1GC -XX:MaxGCPauseMillis=20 -XX:InitiatingHeapOccupancyPercent=35 -XX:G1HeapRegionSize=16M -XX:MinMetaspaceFreeRatio=50 -XX:MaxMetaspaceFreeRatio=80"
  KAFKAREST_OPTS: "{{ kafka_rest_final_java_args | confluent.platform.java_arg_build_out }}"
  # Remove trailing slash if there is one
  LOG_DIR: "{{ kafka_rest_log_dir|regex_replace('\\/$', '') }}"
  CONFLUENT_SECURITY_MASTER_KEY: "{% if kafka_rest_secrets_protection_enabled|bool %}{{secrets_protection_masterkey}}{% endif %}"

### Overrides to the Unit Section of Rest Proxy Systemd File. This variable is a dictionary.
kafka_rest_service_unit_overrides:

### Time in seconds to wait before starting Rest Proxy Health Checks.
kafka_rest_health_check_delay: 15

kafka_rest_secrets_protection_file: "{{ ssl_file_dir_final }}/kafka-rest-security.properties"
