---
##
## USM Agent Authentication Scenarios Inventory
##
## This inventory file demonstrates all 4 USM Agent authentication types:
## 1. No authentication
## 2. Basic authentication
## 3. Basic authentication + TLS
## 4. mTLS (mutual TLS)
##
## Instructions:
## 1. Configure supported CP components: Uncomment desired USM Agent auth scenario in kafka_controller, kafka_broker, and kafka_connect vars sections
## 2. Configure USM Agent server: Adjust variables in the usm_agent.vars section
## 3. Update hostnames to match your environment
## 4. Run: ansible-playbook -i usm_agent_auth_scenarios.yml confluent.platform.all
##
## Key Features:
## - Per-component configuration: Each supported CP component can use different USM Agent auth settings
## - Mixed scenarios supported: e.g., Kafka Controller with mTLS, Kafka Connect with basic auth
## - Server independence: USM Agent server config is separate from client configs
## - Supported components: Kafka Controller, Kafka Broker, Kafka Connect only
##
## Example Mixed Scenario:
## - Kafka Controller: mTLS authentication (high security)
## - Kafka Broker: mTLS authentication (high security)
## - Kafka Connect: Basic + TLS authentication
## - USM Agent server: Configured independently to support all client types

all:
  vars:
    ansible_connection: ssh
    ansible_user: ec2-user
    ansible_become: true
    ansible_ssh_private_key_file: /path/to/your/key.pem
    ansible_python_interpreter: /usr/bin/python3

    ## ═══════════════════════════════════════════════════════════════════════════════════════
    ## CONFLUENT PLATFORM SSL CONFIGURATION
    ## ═══════════════════════════════════════════════════════════════════════════════════════
    ## These settings control SSL for the entire Confluent Platform
    ## They are independent of USM Agent authentication settings
    ##
    ssl_enabled: true
    ssl_mutual_auth_enabled: false

    # Confluent Cloud Configuration (if using CCloud)
    # ccloud_environment_id: "env-xxxxx"
    # ccloud_credential:
    #   username: "your-ccloud-api-key"
    #   password: "your-ccloud-api-secret"



    ## ═══════════════════════════════════════════════════════════════════════════════════════
    ## SSL/TLS Configuration (for scenarios 3 & 4)
    ## ═══════════════════════════════════════════════════════════════════════════════════════
    ## Additional SSL settings can be configured here:
    ##
    # ssl_self_signed: true  # Set to false if using CA-signed certificates
    # ssl_provided_keystore_and_truststore: false  # Set to true if providing your own keystores
    # ssl_keystore_filepath: /path/to/keystore.jks
    # ssl_truststore_filepath: /path/to/truststore.jks
    # ssl_keystore_password: your-keystore-password
    # ssl_truststore_password: your-truststore-password

## ═══════════════════════════════════════════════════════════════════════════════════════════
## USM AGENT ENABLED CONFLUENT PLATFORM COMPONENTS
## ═══════════════════════════════════════════════════════════════════════════════════════════
## Only components that integrate with USM Agent are included in this inventory
## Supported: Kafka Controller, Kafka Broker, Kafka Connect

kafka_controller:
  hosts:
    kafka-controller-1.example.com:
    kafka-controller-2.example.com:
    kafka-controller-3.example.com:
  vars:
    ## ═══════════════════════════════════════════════════════════════════════════════════════
    ## USM AGENT CLIENT CONFIGURATION FOR KAFKA CONTROLLER
    ## ═══════════════════════════════════════════════════════════════════════════════════════
    ## Choose ONE of the following scenarios by uncommenting the appropriate section
    ##

    ## SCENARIO 1: NO AUTHENTICATION
    # usm_agent_url: "http://usm-agent1:10000"
    # usm_agent_client_auth_type: none
    # usm_agent_client_ssl_enabled: false
    # usm_agent_client_ssl_mutual_auth_enabled: false

    ## SCENARIO 2: BASIC AUTHENTICATION (HTTP)
    # usm_agent_url: "http://usm-agent1:10000"
    # usm_agent_client_auth_type: basic
    # usm_agent_client_ssl_enabled: false
    # usm_agent_client_ssl_mutual_auth_enabled: false
    # usm_agent_user: admin
    # usm_agent_password: admin-secret

    ## SCENARIO 3: BASIC AUTHENTICATION + TLS (HTTPS) - ACTIVE
    usm_agent_url: "https://usm-agent1:10000"
    usm_agent_client_auth_type: basic
    usm_agent_client_ssl_enabled: true
    usm_agent_client_ssl_mutual_auth_enabled: false
    usm_agent_user: admin
    usm_agent_password: admin-secret

    ## SCENARIO 4: MUTUAL TLS (mTLS)
    # usm_agent_url: "https://usm-agent1:10000"
    # usm_agent_client_auth_type: mtls
    # usm_agent_client_ssl_enabled: true
    # usm_agent_client_ssl_mutual_auth_enabled: true

kafka_broker:
  hosts:
    kafka-broker-1.example.com:
    kafka-broker-2.example.com:
    kafka-broker-3.example.com:
  vars:
    ## ═══════════════════════════════════════════════════════════════════════════════════════
    ## USM AGENT CLIENT CONFIGURATION FOR KAFKA BROKER
    ## ═══════════════════════════════════════════════════════════════════════════════════════
    ## Choose ONE of the following scenarios by uncommenting the appropriate section
    ##

    ## SCENARIO 1: NO AUTHENTICATION
    # usm_agent_url: "http://usm-agent1:10000"
    # usm_agent_client_auth_type: none
    # usm_agent_client_ssl_enabled: false
    # usm_agent_client_ssl_mutual_auth_enabled: false

    ## SCENARIO 2: BASIC AUTHENTICATION (HTTP)
    # usm_agent_url: "http://usm-agent1:10000"
    # usm_agent_client_auth_type: basic
    # usm_agent_client_ssl_enabled: false
    # usm_agent_client_ssl_mutual_auth_enabled: false
    # usm_agent_user: admin
    # usm_agent_password: admin-secret

    ## SCENARIO 3: BASIC AUTHENTICATION + TLS (HTTPS) - ACTIVE
    usm_agent_url: "https://usm-agent1:10000"
    usm_agent_client_auth_type: basic
    usm_agent_client_ssl_enabled: true
    usm_agent_client_ssl_mutual_auth_enabled: false
    usm_agent_user: admin
    usm_agent_password: admin-secret

    ## SCENARIO 4: MUTUAL TLS (mTLS)
    # usm_agent_url: "https://usm-agent1:10000"
    # usm_agent_client_auth_type: mtls
    # usm_agent_client_ssl_enabled: true
    # usm_agent_client_ssl_mutual_auth_enabled: true



kafka_connect:
  hosts:
    kafka-connect-1.example.com:
    kafka-connect-2.example.com:
  vars:
    ## ═══════════════════════════════════════════════════════════════════════════════════════
    ## USM AGENT CLIENT CONFIGURATION FOR KAFKA CONNECT
    ## ═══════════════════════════════════════════════════════════════════════════════════════
    ## Choose ONE of the following scenarios by uncommenting the appropriate section
    ##

    ## SCENARIO 1: NO AUTHENTICATION
    # usm_agent_url: "http://usm-agent1:10000"
    # usm_agent_client_auth_type: none
    # usm_agent_client_ssl_enabled: false
    # usm_agent_client_ssl_mutual_auth_enabled: false

    ## SCENARIO 2: BASIC AUTHENTICATION (HTTP)
    # usm_agent_url: "http://usm-agent1:10000"
    # usm_agent_client_auth_type: basic
    # usm_agent_client_ssl_enabled: false
    # usm_agent_client_ssl_mutual_auth_enabled: false
    # usm_agent_user: admin
    # usm_agent_password: admin-secret

    ## SCENARIO 3: BASIC AUTHENTICATION + TLS (HTTPS) - ACTIVE
    usm_agent_url: "https://usm-agent1:10000"
    usm_agent_client_auth_type: basic
    usm_agent_client_ssl_enabled: true
    usm_agent_client_ssl_mutual_auth_enabled: false
    usm_agent_user: admin
    usm_agent_password: admin-secret

    ## SCENARIO 4: MUTUAL TLS (mTLS)
    # usm_agent_url: "https://usm-agent1:10000"
    # usm_agent_client_auth_type: mtls
    # usm_agent_client_ssl_enabled: true
    # usm_agent_client_ssl_mutual_auth_enabled: true



## ═══════════════════════════════════════════════════════════════════════════════════════════
## USM AGENT SERVER
## ═══════════════════════════════════════════════════════════════════════════════════════════

usm_agent:
  hosts:
    usm-agent1.example.com:
      # Optional: Override USM Agent specific settings per host
      # usm_agent_admin_port: 9901
      # usm_agent_controlplane_port: 9999
      # usm_agent_dataplane_port: 10000
  vars:
    ## ═══════════════════════════════════════════════════════════════════════════════════════
    ## USM AGENT SERVER CONFIGURATION
    ## ═══════════════════════════════════════════════════════════════════════════════════════
    ## These variables configure the USM Agent server itself
    ##

    # SASL Authentication Protocol
    sasl_protocol: plain  # Options: plain, none

    # SSL Configuration for USM Agent Server
    ssl_enabled: true
    ssl_mutual_auth_enabled: false

    # Custom SSL Certificates (optional - if not provided, Ansible will generate self-signed certs)
    ssl_custom_certs: true
    ssl_ca_cert_filepath: /path/to/confluent-root-certificate.crt
    ssl_signed_cert_filepath: /path/to/server.crt
    ssl_key_filepath: /path/to/server-private-key.key
    ssl_key_password: your-ssl-key-password

    # Basic Auth Users for CP Component Communication (used when sasl_protocol is plain)
    usm_agent_basic_users:
      admin:  # Keep uniformity with other CP components
        principal: admin
        password: admin-secret
      user1:
        principal: user1
        password: user1-secret

    # Confluent Cloud Configuration
    ccloud_endpoint: https://api.confluent.cloud
    ccloud_environment_id: env-xxxxx
    ccloud_credential:
      username: your-ccloud-api-key
      password: your-ccloud-api-secret
