# Jolokia Access Control Configuration Guide
#
# This file explains how to configure Jolokia access control variables for secure
# JMX monitoring in Confluent Platform deployments.
#
# Jolokia Access Control Variables Overview:
# ==========================================
#
# These variables control the security of the Jolokia JMX agent endpoint.
# Jolokia access control restricts JMX operations via an XML policy file,
# providing fine-grained control over which MBeans and operations are accessible.
#
# Key Variables:
# --------------
#
# jolokia_access_control_enabled:
#   - Enables Jolokia's access control feature
#   - When enabled, restricts JMX operations via an XML policy file
#   - By default, this is enabled if Jolokia itself is enabled
#   - Type: boolean
#   - Default: false
#
# jolokia_access_control_custom_file_enabled:
#   - Must be set to true or false when access control is enabled
#   - Controls whether to use a custom XML policy file or the built-in secure default
#   - Options:
#     * true: You must provide your own secure XML file via jolokia_access_control_file_src_path
#     * false: The playbooks will use a secure default XML file provided by the role
#     * null: Forces you to make an explicit choice for security (recommended for production)
#   - Type: boolean or null
#   - Default: false
#
# jolokia_access_control_file_src_path:
#   - Full path on the Ansible controller to your custom Jolokia access control XML file
#   - Required if jolokia_access_control_custom_file_enabled is true
#   - The file will be copied to all target nodes
#   - Type: string (file path)
#   - Default: ""
#
# jolokia_access_control_file_dest_path:
#   - Path on the target node where the access control XML will be placed
#   - This is referenced by the Jolokia agent at runtime
#   - Should be accessible by the component's service user
#   - Type: string (directory path)
#   - Default: /opt/jolokia
#
# Component-Specific Variables:
# =============================
#
# Each component has its own set of Jolokia access control variables:
# - zookeeper_jolokia_access_control_enabled
# - zookeeper_jolokia_access_control_custom_file_enabled
# - kafka_controller_jolokia_access_control_enabled
# - kafka_controller_jolokia_access_control_custom_file_enabled
# - kafka_broker_jolokia_access_control_enabled
# - kafka_broker_jolokia_access_control_custom_file_enabled
# - kafka_connect_jolokia_access_control_enabled
# - kafka_connect_jolokia_access_control_custom_file_enabled
# - kafka_rest_jolokia_access_control_enabled
# - kafka_rest_jolokia_access_control_custom_file_enabled
# - ksql_jolokia_access_control_enabled
# - ksql_jolokia_access_control_custom_file_enabled
# - schema_registry_jolokia_access_control_enabled
# - schema_registry_jolokia_access_control_custom_file_enabled
# - kafka_connect_replicator_jolokia_access_control_enabled
# - kafka_connect_replicator_jolokia_access_control_custom_file_enabled
#
# Usage Examples:
# ===============

# Example 1: Enable access control with default secure configuration
all:
  vars:
    jolokia_enabled: true
    jolokia_access_control_enabled: true
    jolokia_access_control_custom_file_enabled: false

# Example 2: Enable access control with custom XML policy file
all:
  vars:
    jolokia_enabled: true
    jolokia_access_control_enabled: true
    jolokia_access_control_custom_file_enabled: true
    jolokia_access_control_file_src_path: "/path/to/your/jolokia-access.xml"
    jolokia_access_control_file_dest_path: "/opt/jolokia"

# Example 3: Component-specific configuration
all:
  vars:
    jolokia_enabled: true
    # Global default
    jolokia_access_control_enabled: true
    jolokia_access_control_custom_file_enabled: false

kafka_broker:
  vars:
    # Override for brokers only - use custom policy
    kafka_broker_jolokia_access_control_custom_file_enabled: true
    kafka_broker_jolokia_access_control_file_src_path: "/path/to/broker-jolokia-access.xml"

# Example 4: Production-ready configuration with explicit choices
all:
  vars:
    jolokia_enabled: true
    jolokia_access_control_enabled: true
    # Force explicit choice in production
    jolokia_access_control_custom_file_enabled: null

# This will require each component to explicitly set their custom_file_enabled value

# Security Considerations:
# ========================
#
# 1. Always enable access control in production environments
# 2. Use custom XML policy files for fine-grained control
# 3. Regularly review and update access control policies
# 4. Test access control policies in development before production deployment
# 5. Monitor Jolokia logs for unauthorized access attempts
#
# Sample Custom Access Control XML:
# ==================================
#
# Create a file like /path/to/jolokia-access.xml with content similar to:
#
# <?xml version="1.0" encoding="utf-8"?>
# <restrict>
#   <!-- Allow access to specific MBeans only -->
#   <allow>
#     <mbean>kafka.controller:type=KafkaController,name=*</mbean>
#     <operation>read</operation>
#   </allow>
#
#   <!-- Deny all other access -->
#   <deny>
#     <mbean>*:*</mbean>
#   </deny>
# </restrict>
#
# For more information on Jolokia access control XML format, see:
# https://jolokia.org/reference/html/security.html
