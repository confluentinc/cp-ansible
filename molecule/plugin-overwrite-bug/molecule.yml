---
### Test case for plugin overwrite bug fix
### Tests that custom JAR files are preserved during plugin installation
### Kafka Connect plugin installation with custom JAR files
### Archive installation method testing
### Plugin overwrite bug fix validation

driver:
  name: docker
platforms:
  - name: kafka-connect1
    hostname: kafka-connect1.confluent
    groups:
      - kafka_connect
    image: geerlingguy/docker-centos7-ansible
    dockerfile: ../Dockerfile.j2
    command: ""
    volumes:
      - /sys/fs/cgroup:/sys/fs/cgroup:ro
    privileged: true
    published_ports:
      - "8083:8083"
    networks:
      - name: confluent
provisioner:
  inventory:
    group_vars:
      all:
        # Test configuration for plugin overwrite bug
        installation_method: archive
        kafka_connect_confluent_hub_plugins:
          - jcustenborder/kafka-connect-spooldir:2.0.43
        kafka_connect_plugins: []
        kafka_connect_plugins_remote: []
        kafka_connect_copy_files:
          - source_path: "{{ lookup('env', 'MOLECULE_SCENARIO_DIRECTORY') }}/test-jars/ibm-mq-connector.jar"
            destination_path: /usr/share/java/connect_plugins/jcustenborder-kafka-connect-spooldir/ibm-mq-connector.jar
            owner: cp-kafka-connect
            group: confluent
            mode: '0644'
verifier:
  name: ansible
