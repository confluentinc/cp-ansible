---
- name: Setup vm dns
  import_playbook: ../dns.yml

- name: File Based login in C3/CLI configs via override
  hosts: kafka_broker
  tasks:
    - name: Copy Credentials file to MDS
      copy:
        src: "{{ lookup('env', 'MOLECULE_SCENARIO_DIRECTORY') }}/credentials"
        dest: "/tmp/credentials"

- name: Create Custom Certs
  import_playbook: ../certificates.yml

- name: Install MDS Cluster
  import_playbook: confluent.platform.all

- name: Install Zookeeper Cluster
  import_playbook: ../multi_rbac_converge.yml
  when: lookup('env', 'MIGRATION')|default('false') == 'true'
