<?xml version="1.0" encoding="utf-8"?>
<!--
  Kafka Broker - Selective Access Control for Testing
  Strategy: Allow specific MBeans for monitoring, deny everything else
  1. Allow access to essential Kafka broker metrics
  2. Allow basic JVM memory information
  3. Block all other MBeans and sensitive operations
-->
<restrict>
  <!-- Allow specific Kafka broker metrics -->
  <allow>
    <mbean>kafka.server:type=BrokerTopicMetrics,name=MessagesInPerSec</mbean>
    <operation>read</operation>
  </allow>

  <!-- Allow JVM memory information for basic monitoring -->
  <allow>
    <mbean>java.lang:type=Memory</mbean>
    <operation>read</operation>
  </allow>

  <!-- Allow Kafka server general metrics -->
  <allow>
    <mbean>kafka.server:type=KafkaServer,name=BrokerState</mbean>
    <operation>read</operation>
  </allow>

  <!-- Deny all other access -->
  <deny>
    <mbean>*:*</mbean>
    <operation>*</operation>
  </deny>
</restrict>
