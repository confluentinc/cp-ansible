<?xml version="1.0" encoding="utf-8"?>
<!--
  Kafka Broker - Defense in Depth Security for Testing
  Strategy: Deny All Commands + Allow Specific MBeans
  1. Allow ONLY read command globally (blocks list, write, exec, search, notification, version)
  2. Allow only specific MBeans for broker monitoring
  3. Fine-grained attribute and operation control
-->
<restrict>
  <!-- ALLOW ONLY read command globally (blocks list, write, exec, search, notification, version) -->
  <commands>
    <command>read</command>
  </commands>

  <!-- ALLOW ONLY - Specific MBeans for Kafka Broker Monitoring -->
  <allow>
    <mbean>
      <name>kafka.server:name=MessagesInPerSec,type=BrokerTopicMetrics</name>
      <attribute mode="read">*</attribute>
    </mbean>
  </allow>

  <allow>
    <mbean>
      <name>java.lang:type=Memory</name>
      <attribute mode="read">*</attribute>
    </mbean>
  </allow>

  <allow>
    <mbean>
      <name>kafka.server:name=BrokerState,type=KafkaServer</name>
      <attribute mode="read">*</attribute>
    </mbean>
  </allow>

</restrict>
